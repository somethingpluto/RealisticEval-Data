i
m
p
o
r
t
 
p
a
n
d
a
s


i
m
p
o
r
t
 
p
a
n
d
a
s
 
a
s
 
p
d






d
e
f
 
f
i
l
l
_
m
i
s
s
i
n
g
_
w
i
t
h
_
f
i
r
s
t
_
v
a
l
i
d
(
d
f
:
 
p
a
n
d
a
s
.
D
a
t
a
F
r
a
m
e
,
 
c
o
l
u
m
n
_
n
a
m
e
:
 
s
t
r
)
 
-
>
 
p
d
.
D
a
t
a
F
r
a
m
e
:


 
 
 
 
"
"
"


 
 
 
 
F
i
l
l
s
 
m
i
s
s
i
n
g
 
v
a
l
u
e
s
 
i
n
 
t
h
e
 
s
p
e
c
i
f
i
e
d
 
c
o
l
u
m
n
 
o
f
 
t
h
e
 
D
a
t
a
F
r
a
m
e
 
w
i
t
h
 
t
h
e
 
f
i
r
s
t
 
v
a
l
i
d
 
v
a
l
u
e
 
i
n
 
t
h
a
t
 
c
o
l
u
m
n
.


 
 
 
 
A
r
g
s
:


 
 
 
 
 
 
 
 
d
f
 
(
p
a
n
d
a
s
.
D
a
t
a
F
r
a
m
e
)
:
 
T
h
e
 
p
a
n
d
a
s
 
D
a
t
a
F
r
a
m
e
.


 
 
 
 
 
 
 
 
c
o
l
u
m
n
_
n
a
m
e
 
(
s
t
r
)
:
 
T
h
e
 
n
a
m
e
 
o
f
 
t
h
e
 
c
o
l
u
m
n
 
t
o
 
f
i
l
l
 
m
i
s
s
i
n
g
 
v
a
l
u
e
s
.




 
 
 
 
R
e
t
u
r
n
s
:


 
 
 
 
 
 
 
 
p
d
.
D
a
t
a
F
r
a
m
e
:
 
T
h
e
 
D
a
t
a
F
r
a
m
e
 
w
i
t
h
 
m
i
s
s
i
n
g
 
v
a
l
u
e
s
 
f
i
l
l
e
d
.


 
 
 
 
"
"
"


 
 
 
 
d
f
[
c
o
l
u
m
n
_
n
a
m
e
]
 
=
 
d
f
[
c
o
l
u
m
n
_
n
a
m
e
]
.
f
i
l
l
n
a
(
m
e
t
h
o
d
=
'
f
f
i
l
l
'
)


 
 
 
 
r
e
t
u
r
n
 
d
f






d
e
f
 
f
i
l
l
_
m
i
s
s
i
n
g
_
w
i
t
h
_
l
a
s
t
_
v
a
l
i
d
(
d
f
:
 
p
a
n
d
a
s
.
D
a
t
a
F
r
a
m
e
,
 
c
o
l
u
m
n
_
n
a
m
e
:
 
s
t
r
)
 
-
>
 
p
d
.
D
a
t
a
F
r
a
m
e
:


 
 
 
 
"
"
"


 
 
 
 
F
i
l
l
s
 
m
i
s
s
i
n
g
 
v
a
l
u
e
s
 
i
n
 
t
h
e
 
s
p
e
c
i
f
i
e
d
 
c
o
l
u
m
n
 
o
f
 
t
h
e
 
D
a
t
a
F
r
a
m
e
 
w
i
t
h
 
t
h
e
 
l
a
s
t
 
v
a
l
i
d
 
v
a
l
u
e
 
i
n
 
t
h
a
t
 
c
o
l
u
m
n
.


 
 
 
 
A
r
g
s
:


 
 
 
 
 
 
 
 
d
f
 
(
p
a
n
d
a
s
.
D
a
t
a
F
r
a
m
e
)
:
 
T
h
e
 
p
a
n
d
a
s
 
D
a
t
a
F
r
a
m
e
.


 
 
 
 
 
 
 
 
c
o
l
u
m
n
_
n
a
m
e
 
(
s
t
r
)
:
 
T
h
e
 
n
a
m
e
 
o
f
 
t
h
e
 
c
o
l
u
m
n
 
t
o
 
f
i
l
l
 
m
i
s
s
i
n
g
 
v
a
l
u
e
s
.




 
 
 
 
R
e
t
u
r
n
s
:


 
 
 
 
 
 
 
 
p
d
.
D
a
t
a
F
r
a
m
e
:
 
T
h
e
 
D
a
t
a
F
r
a
m
e
 
w
i
t
h
 
m
i
s
s
i
n
g
 
v
a
l
u
e
s
 
f
i
l
l
e
d
.


 
 
 
 
"
"
"


 
 
 
 
d
f
[
c
o
l
u
m
n
_
n
a
m
e
]
 
=
 
d
f
[
c
o
l
u
m
n
_
n
a
m
e
]
.
f
i
l
l
n
a
(
m
e
t
h
o
d
=
'
b
f
i
l
l
'
)


 
 
 
 
r
e
t
u
r
n
 
d
f






d
e
f
 
f
i
l
l
_
m
i
s
s
i
n
g
_
w
i
t
h
_
m
e
a
n
(
d
f
:
 
p
a
n
d
a
s
.
D
a
t
a
F
r
a
m
e
,
 
c
o
l
u
m
n
_
n
a
m
e
:
 
s
t
r
)
 
-
>
 
p
d
.
D
a
t
a
F
r
a
m
e
:


 
 
 
 
"
"
"


 
 
 
 
F
i
l
l
s
 
m
i
s
s
i
n
g
 
v
a
l
u
e
s
 
i
n
 
t
h
e
 
s
p
e
c
i
f
i
e
d
 
c
o
l
u
m
n
 
o
f
 
t
h
e
 
D
a
t
a
F
r
a
m
e
 
w
i
t
h
 
t
h
e
 
m
e
a
n
 
v
a
l
u
e
 
i
n
 
t
h
a
t
 
c
o
l
u
m
n
.


 
 
 
 
A
r
g
s
:


 
 
 
 
 
 
 
 
d
f
 
(
p
a
n
d
a
s
.
D
a
t
a
F
r
a
m
e
)
:
 
T
h
e
 
p
a
n
d
a
s
 
D
a
t
a
F
r
a
m
e
.


 
 
 
 
 
 
 
 
c
o
l
u
m
n
_
n
a
m
e
 
(
s
t
r
)
:
 
T
h
e
 
n
a
m
e
 
o
f
 
t
h
e
 
c
o
l
u
m
n
 
t
o
 
f
i
l
l
 
m
i
s
s
i
n
g
 
v
a
l
u
e
s
.




 
 
 
 
R
e
t
u
r
n
s
:


 
 
 
 
 
 
 
 
p
d
.
D
a
t
a
F
r
a
m
e
:
 
T
h
e
 
D
a
t
a
F
r
a
m
e
 
w
i
t
h
 
m
i
s
s
i
n
g
 
v
a
l
u
e
s
 
f
i
l
l
e
d
.


 
 
 
 
"
"
"


 
 
 
 
d
f
[
c
o
l
u
m
n
_
n
a
m
e
]
 
=
 
d
f
[
c
o
l
u
m
n
_
n
a
m
e
]
.
f
i
l
l
n
a
(
d
f
[
c
o
l
u
m
n
_
n
a
m
e
]
.
m
e
a
n
(
)
)


 
 
 
 
r
e
t
u
r
n
 
d
f






d
e
f
 
f
i
l
l
_
m
i
s
s
i
n
g
_
w
i
t
h
_
m
e
d
i
a
n
(
d
f
:
 
p
a
n
d
a
s
.
D
a
t
a
F
r
a
m
e
,
 
c
o
l
u
m
n
_
n
a
m
e
:
 
s
t
r
)
 
-
>
 
p
d
.
D
a
t
a
F
r
a
m
e
:


 
 
 
 
"
"
"


 
 
 
 
F
i
l
l
s
 
m
i
s
s
i
n
g
 
v
a
l
u
e
s
 
i
n
 
t
h
e
 
s
p
e
c
i
f
i
e
d
 
c
o
l
u
m
n
 
o
f
 
t
h
e
 
D
a
t
a
F
r
a
m
e
 
w
i
t
h
 
t
h
e
import unittest

import pandas as pd


class TestFillMissingWithFirstValid(unittest.TestCase):

    def test_basic_filling(self):
        df = pd.DataFrame({'A': [1, None, 3, None], 'B': ['foo', 'bar', None, 'baz']})
        result = fill_missing_with_first_valid(df, 'B')
        expected = pd.DataFrame({'A': [1, None, 3, None], 'B': ['foo', 'bar', 'foo', 'baz']})
        pd.testing.assert_frame_equal(result, expected)

    def test_no_missing_values(self):
        df = pd.DataFrame({'A': [1, 2, 3], 'B': ['foo', 'bar', 'baz']})
        result = fill_missing_with_first_valid(df, 'B')
        expected = pd.DataFrame({'A': [1, 2, 3], 'B': ['foo', 'bar', 'baz']})
        pd.testing.assert_frame_equal(result, expected)


    def test_single_valid_value(self):
        df = pd.DataFrame({'A': [1, None, None, 4], 'B': [None, 'bar', None, None]})
        result = fill_missing_with_first_valid(df, 'B')
        expected = pd.DataFrame({'A': [1, None, None, 4], 'B': ['bar', 'bar', 'bar', 'bar']})
        pd.testing.assert_frame_equal(result, expected)

    def test_multiple_valid_values(self):
        df = pd.DataFrame({'A': [1, None, 3, 4], 'B': [None, 'bar', 'foo', None]})
        result = fill_missing_with_first_valid(df, 'B')
        expected = pd.DataFrame({'A': [1, None, 3, 4], 'B': ['bar', 'bar', 'foo', 'bar']})
        pd.testing.assert_frame_equal(result, expected)

if __name__ == '__main__':
    unittest.main()