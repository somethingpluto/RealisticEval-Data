var assert = require('assert');
var should = require('should');

var BitArray = require('../bitArray');

describe('BitArray', function () {
    describe('Properties', function () {
        it('should have a length property', function () {
            BitArray.should.have.property('length');
        });
    });

    describe('Methods', function () {
        describe('getBit(index)', function () {
            it('should return the bit at that index', function () {
                bitArray = new BitArray(8);
                bitArray.setBit(0, 1);
                bitArray.setBit(7, 1);
                
                bitArray.getBit(0).should.be.exactly(1);
                bitArray.getBit(1).should.be.exactly(0);
                bitArray.getBit(6).should.be.exactly(0);
                bitArray.getBit(7).should.be.exactly(1);

                bitArray.setBit(0, 0);
                bitArray.setBit(7, 0);

                bitArray.getBit(0).should.be.exactly(0);
                bitArray.getBit(1).should.be.exactly(0);
                bitArray.getBit(6).should.be.exactly(0);
                bitArray.getBit(7).should.be.exactly(0);
            });
        });

        describe('setBit(index)', function () {
            it('should set the bit at that index', function () {
                bitArray = new BitArray(8);
                bitArray.setBit(0, 1).should.be.exactly(1);
                bitArray.setBit(7, 1).should.be.exactly(1);
                
                bitArray.getBit(0).should.be.exactly(1);
                bitArray.getBit(1).should.be.exactly(0);
                bitArray.getBit(6).should.be.exactly(0);
                bitArray.getBit(7).should.be.exactly(1);

                bitArray.setBit(0, 0).should.be.exactly(0);
                bitArray.setBit(7, 0).should.be.exactly(0);

                bitArray.getBit(0).should.be.exactly(0);
                bitArray.getBit(1).should.be.exactly(0);
                bitArray.getBit(6).should.be.exactly(0);
                bitArray.getBit(7).should.be.exactly(0);
            });
        });

        describe('getBuffer()', function () {
            it('should return the ArrayBuffer', function () {
                bitArray = new BitArray(8);
                bitArray.setBit(0, 1);
                bitArray.setBit(7, 1); 
                var buffer = bitArray.getBuffer()
                buffer.should.be.instanceof(ArrayBuffer);
                buffer[0].should.be.exactly(129);
            });
        });
    });
});
